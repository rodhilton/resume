<% load 'common.rb' %>

<% 
  def latex_links(one)
    one.gsub(/<a href=(["'])(.*?)\1>(.*?)<\/a>/, "\\href{\\2}{\\3}")
  end

  def latex_desc(bla)
    bla.gsub(/%/, "\\%")
  end
%>

% LaTeX resume using res.cls
\documentclass[margin]{res}
%\usepackage{helvetica} % uses helvetica postscript font (download helvetica.sty)
%\usepackage{newcent}   % uses new century schoolbook postscript font 
\usepackage{hyperref}
\usepackage{ifthen}
\usepackage{tabularx} 

\hypersetup{
   pdfborder={0 0 0},
   colorlinks=true,
    linkcolor=red,          % color of internal links
    citecolor=green,        % color of links to bibliography
    filecolor=magenta,      % color of file links
    urlcolor=blue           % color of external links
}
\setlength{\textwidth}{5.1in} % set width of text portion
\setlength{\textheight}{9.5in} % increase text height to fit resume on 1 page

% Macros -----

\newenvironment{resumesection}[1]
{
\section{\uppercase{#1}}
}
{
}

% End Macros ----


\begin{document}

\moveleft\hoffset\vbox{\begin{tabular*}{\resumewidth}{@{\extracolsep{\fill}} l c r }
  <%= flags[:email] %> & 
  \large\bf <%= name %> & 
  <%= flags[:phone] %> \\
\end{tabular*}}\smallskip

\moveleft\hoffset\vbox{\hrule width\resumewidth height 1pt}\smallskip

\begin{resume}
  
\begin{resumesection}{Summary}
\begin{list}{$ \cdot $}{\leftmargin=.5em} \itemsep 2pt
<% summary.each do |summary_item| %>
	\item <%= summary_item %>

<% end %>
\end{list}
\end{resumesection}

\section{SKILLS}
<% u_skills = unique_skills(skills) %>
{\bf Accomplished:} <%= skill_list(u_skills, 7, 10).gsub(/\#/, "\\#") %> \\
{\bf Advanced:} <%= skill_list(u_skills, 5, 6).gsub(/\#/, "\\#") %> \\
{\bf Novice:} <%= skill_list(u_skills, 0, 4).gsub(/\#/, "\\#") %>


\section{EXPERIENCE}
<% job_list = flags[:complete_history] ? experience.jobs : trim_jobs(experience.jobs) %>
\vspace{1.2 mm}
<% job_list.each do |job| %>
  \begin{minipage}{\linewidth} 
  {\bf <%= job.title %>} \hfill <%= job.time %> \\
  {\sl <%= job.company %> }
  \begin{list}{$ \cdot $}{\leftmargin=1.5em} \itemsep .5pt
  \footnotesize
  <% accomplishments = flags[:complete_history] ? job.accomplishments : trim_accomplishments(job.accomplishments) %>
  	<% accomplishments.each do |accomplishment| %>
  		\item <%= latex_links(latex_desc(accomplishment)) %>
  	<% end %>
  \end{list}
  \end{minipage}
<% end %>


<% if flags[:certifications] %>
\section{CERTIFI-\\ CATIONS}

<% certifications.each do |certification| %> <%= certification.title %> <%= "- #{certification.subject}" if certification.subject %> - <%= certification.time %> \\ 
<% end %>
<% end %>


\section{EDUCATION}
<% education.degrees.each do |degree| %>
\begin{minipage}{\linewidth} 
{\bf <%= degree.title %>} \hfill <%= display_schoolyear(degree, flags[:expand_school ],"","") %> \\
  {\sl <%= degree.school %> }
	 <% if flags[:expand_school ]%>
    \begin{list}{$ \cdot $}{\leftmargin=1.5em} \itemsep .5pt
		\footnotesize
			\item <%= latex_links(degree.note) %>
			\item Coursework: <%= degree.coursework %>
		\end{list}
    <% end %>
    \end{minipage}
<% end %>

\end{resume}
\end{document}
